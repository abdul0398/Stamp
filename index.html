<!doctype html>
<html>
    <head>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

        <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.15.2/css/selectize.default.min.css"
        integrity="sha512-pTaEn+6gF1IeWv3W1+7X7eM60TFu/agjgoHmYhAfLEU8Phuf6JKiiE8YmsNC0aCgQv4192s4Vai8YZ6VNM6vyQ=="
        crossorigin="anonymous"
        referrerpolicy="no-referrer"
        />
        <script
        src="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.15.2/js/selectize.min.js"
        integrity="sha512-IOebNkvA/HZjMM7MxL0NYeLYEalloZ8ckak+NDtOViP7oiYzG5vn6WVXyrJDiJPhl4yRdmNAG49iuLmhkUdVsQ=="
        crossorigin="anonymous"
        referrerpolicy="no-referrer"
        ></script>
        <style type="text/css">
            .hide{
                display: none;
            }
            @font-face {
                font-family: AvenirSubset;
                src: url('/spa-assets/fonts/avenir-optimized-subset.woff2') format('woff2'), url('/spa-assets/fonts/avenir-optimized-subset.woff') format('woff');
                unicode-range: U+24,U+2C,U+30-39,U+41-5A,U+61-7A;
                font-display: swap;
            }

            @font-face {
                font-family: "Avenir Next";
                src: url("/spa-assets/fonts/avenir-regular.woff2") format("woff2"), url("/spa-assets/fonts/avenir-regular.woff") format("woff");
                font-display: swap;
            }

            @font-face {
                font-family: "Avenir Next";
                src: url("/spa-assets/fonts/avenir-medium.woff2") format("woff2"), url("/spa-assets/fonts/avenir-medium.woff") format("woff");
                font-weight: 500;
                font-display: swap;
            }

            @font-face {
                font-family: "Avenir Next";
                src: url("/spa-assets/fonts/avenir-demibold.woff2") format("woff2"), url("/spa-assets/fonts/avenir-demibold.woff") format("woff");
                font-weight: 600;
                font-display: swap;
            }

            @font-face {
                font-family: "Avenir Next";
                src: url("/spa-assets/fonts/avenir-bold.woff2") format("woff2"), url("/spa-assets/fonts/avenir-bold.woff") format("woff");
                font-weight: bold;
                font-display: swap;
            }

            body {
                font-family: sans-serif;
            }

            .fonts-loaded-1 body {
                font-family: AvenirSubset;
            }

            .fonts-loaded-2 body {
                font-family: "Avenir Next", sans-serif;
            }
            #btn_cal{
            border: none;
            background-color: #1a2258;
            color: white;
            padding: 8px 24px;
            border-radius: 4px;
            font-weight: 900;
            }
            #btn_cal:hover{
                cursor: pointer;
            }
        </style>

        <link
            href="https://spaassets.99.co/spa-assets/dist/desktop.a24a03a2c21035230a14.css"
            rel="preload" as="style" type="text/css" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/1189.b114c41bdbfe7a0f1c2c.css"
            rel="preload" as="style" type="text/css" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/typography.10fa7bec6ab934700cf3.css"
            rel="preload" as="style" type="text/css" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/mobileForms.d6cb3acb66b0a2b63268.css"
            rel="preload" as="style" type="text/css" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/desktopForms.5172692ce7436bfd3404.css"
            rel="preload" as="style" type="text/css" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/5227.9f9694d6c397ec8d446b.css"
            rel="preload" as="style" type="text/css" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/4603.b910d4afdc8dc2107ad3.css"
            rel="preload" as="style" type="text/css" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/2972.ecffea9a96043b339c04.css"
            rel="preload" as="style" type="text/css" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/pages/StampDutyCalculator-page-dweb-js.9d204268c67baf077d3a.css"
            rel="preload" as="style" type="text/css" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/desktopForms.5172692ce7436bfd3404.js"
            rel="preload" as="script" type="text/javascript" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/4603.b910d4afdc8dc2107ad3.js"
            rel="preload" as="script" type="text/javascript" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/pages/StampDutyCalculator-page-dweb-js.9d204268c67baf077d3a.js"
            rel="preload" as="script" type="text/javascript" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/mobileForms.d6cb3acb66b0a2b63268.js"
            rel="preload" as="script" type="text/javascript" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/typography.10fa7bec6ab934700cf3.js"
            rel="preload" as="script" type="text/javascript" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/4313.92e6d09fa0af16b5b93c.js"
            rel="preload" as="script" type="text/javascript" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/6749.e5eefe9505f848fece8d.js"
            rel="preload" as="script" type="text/javascript" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/1440.9ec9217efbdc7998dc82.js"
            rel="preload" as="script" type="text/javascript" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/1189.b114c41bdbfe7a0f1c2c.js"
            rel="preload" as="script" type="text/javascript" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/7258.3e2052f6164410a8936b.js"
            rel="preload" as="script" type="text/javascript" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/desktop.6dbbad5145b7818572dc.js"
            rel="preload" as="script" type="text/javascript" />

        <link
            href="https://spaassets.99.co/spa-assets/dist/desktop.a24a03a2c21035230a14.css"
            rel="stylesheet" type="text/css" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/1189.b114c41bdbfe7a0f1c2c.css"
            rel="stylesheet" type="text/css" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/typography.10fa7bec6ab934700cf3.css"
            rel="stylesheet" type="text/css" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/mobileForms.d6cb3acb66b0a2b63268.css"
            rel="stylesheet" type="text/css" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/desktopForms.5172692ce7436bfd3404.css"
            rel="stylesheet" type="text/css" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/5227.9f9694d6c397ec8d446b.css"
            rel="stylesheet" type="text/css" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/4603.b910d4afdc8dc2107ad3.css"
            rel="stylesheet" type="text/css" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/2972.ecffea9a96043b339c04.css"
            rel="stylesheet" type="text/css" />
        <link
            href="https://spaassets.99.co/spa-assets/dist/pages/StampDutyCalculator-page-dweb-js.9d204268c67baf077d3a.css"
            rel="stylesheet" type="text/css" />
        <script src="/spa-assets/external-js/segment/prod.segment.js" async
            type="3bd24bfe0fc7d88de4c47573-text/javascript"></script>
    </head>
    <body itemType="https://schema.org/WebPage" itemscope>
        <div id="content">
            <div>
                <div id="appContent" class="undefined">
                    <div class="tracking-root">
                        <main>
                            <h1 class="Z0npN _3h19g">Stamp Duty Calculator 2023</h1>
                            <section class="_2dkYY">
                                <div class="X3gwL">
                                    <div class="_2cnD5">
                                        <form action="#">
                                            <div class="HusVm">
                                                <p>Application status</p>
                                                <div role="group"
                                                    aria-labelledby="application-status"
                                                    class="_2UN1r">
                                                    <p>
                                                        <input type="radio"
                                                            name="application_status"
                                                            value="single"
                                                            checked id="single" />
                                                        <span class="E0ZzV"></span>
                                                        <label for="single"
                                                            class="_3f2OE">Single</label>
                                                    </p>
                                                    <p>
                                                        <input type="radio"
                                                            name="application_status"
                                                            value="joint"
                                                            id="joint" />
                                                        <span class="E0ZzV"></span>
                                                        <label for="joint"
                                                            class="_3f2OE">Joint</label>
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="_3GrL7">
                                                <label for="residency">
                                                    <span>Residency</span>
                                                    <svg
                                                        xmlns="http://www.w3.org/2000/svg"
                                                        width="18" height="18"
                                                        viewBox="0 0 16 16"
                                                        data-for="info"
                                                        data-tip="true"
                                                        class="_31M2z">
                                                        <g fill-rule="evenodd">
                                                            <path
                                                                d="M8 14.406c3.509 0 6.406-2.897 6.406-6.407 0-3.515-2.904-6.412-6.413-6.412-3.51 0-6.406 2.897-6.406 6.412 0 3.51 2.897 6.407 6.412 6.407zm0-1.374c-2.794 0-5.033-2.246-5.033-5.033 0-2.793 2.233-5.039 5.026-5.039 2.793 0 5.032 2.246 5.039 5.04.006 2.786-2.246 5.032-5.033 5.032zm-.033-7.07c.482 0 .86-.391.86-.86 0-.488-.378-.872-.86-.872-.469 0-.86.384-.86.872 0 .469.391.86.86.86zm-1.061 5.364c-.293 0-.515-.208-.515-.501 0-.28.222-.495.515-.495h.716V7.882h-.606c-.293 0-.514-.208-.514-.501 0-.28.221-.495.514-.495h1.179c.364 0 .56.248.56.638v2.806h.644c.287 0 .514.215.514.495 0 .293-.227.501-.514.501H6.906z"
                                                                fill="currentColor"></path>
                                                        </g>
                                                    </svg>
                                                </label>
                                                <div class="ODlt9">
                                                    <div class="_1-Ycc" style="display: flex; width: 100%; justify-content: space-between;">
                                                       <select id="single_select" style="width: 49%; background-color: transparent;">
                                                        <option selected value="Singaporean">Singaporean</option>
                                                        <option  value="PR">PR</option>
                                                        <option  value="Foreigner">Foreigner</option>
                                                    </select>
                                                    <div style="width: 49%;" class="hide" id="joint_select_div">
                                                        <select id="joint_select" style="width: 100%;"  id="joint_select">
                                                         <option selected value="Singaporean">Singaporean</option>
                                                         <option  value="PR">PR</option>
                                                         <option  value="Foreigner">Foreigner</option>
                                                        </select>
                                                    </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="pLVoc">
                                                <label for="properties_owned">
                                                    <span>Properties owned</span>
                                                </label>
                                                <div>
                                                    <div class="PXjss">
                                                        <input type="text"
                                                        oninput="removeZero(this)"
                                                            id="properties_owned"
                                                            name="properties_owned"
                                                            class="HiIVu"
                                                            value="0" />
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="pLVoc">
                                                <label for="property_value">
                                                    <span>Purchased price</span>
                                                </label>
                                                <div>
                                                    <div class="PXjss">
                                                        <span class="_2If0y">$</span>
                                                        <input type="text"
                                                        oninput="removeZero(this)"
                                                            id="property_value"
                                                            name="property_value"
                                                            class
                                                            value="0" />
                                                    </div>
                                                </div>
                                            </div>
                                            <div style=" margin-top:30px; text-align: center;">
                                                <button id="btn_cal" >Calculate</button>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="_2cnGs">
                                        <div class="_2FndZ">
                                            <h4 class="yMCxv _1vzK2">Buyer
                                                &#x27;s Stamp Duty</h4>
                                            <p class="_2sIc2 _2rhE-" id="stamp_small">$0</p>
                                        </div>
                                        <div class="_2FndZ">
                                            <h4 class="yMCxv _1vzK2">Additional
                                                Buyer &#x27;s Stamp Duty</h4>
                                            <p class="_2sIc2 _2rhE-" id="ABSD">$0</p>
                                        </div>
                                        <div class="_2MIAs">
                                            <h4 class="yMCxv _1vzK2">Total stamp
                                                duty:</h4>
                                            <p class="_2sIc2 _2rhE-">
                                                <span id="stamp_main">$0</span>
                                            </p>
                                        </div>
                                        <div class="Lp0qE">
                                            
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>
                </div>
                <script>

                    document.getElementById("btn_cal").addEventListener("click", ()=>{
                        event.preventDefault();

                        const price = parseInt(document.getElementById("property_value").value);
                        const properties_owned = parseInt(document.getElementById("properties_owned").value);
                        const joint_select = document.getElementById("joint").checked?document.getElementById("joint_select").value:null;
                        const single_select = document.getElementById("single_select").value;
                        
                        const BSD = calculateBSD(price);
                        const ABSD = properties_owned == 0?calculateABSDWithZeroProperty(single_select, joint_select) * price: calculateABSD(properties_owned,single_select, joint_select) * price;
                        


                        animateNumber(BSD, "stamp_small");
                        animateNumber(ABSD, "ABSD");
                        animateNumber(BSD + ABSD, "stamp_main");
                        
                    })



                    document.getElementById("joint").addEventListener("change", ()=>{
                        document.getElementById("joint_select_div").classList.remove("hide")
                    })

                    document.getElementById("single").addEventListener("change", ()=>{
                        document.getElementById("joint_select_div").classList.add("hide")
                    })

                    function animateNumber(end, elementId) {
                        let counterElement = document.getElementById(elementId);
                        let currentNumber = 0;

                        let increment = Math.floor(end / 50);
                        let intervalId = setInterval(function () {
                        counterElement.textContent = formatNumberToDollar(currentNumber);

                        if (currentNumber >= end) {
                            clearInterval(intervalId); 
                        } else {
                            if(currentNumber + increment >= end){
                                currentNumber = end
                                currentNumber = Math.floor(currentNumber);
                                
                            }else{
                                currentNumber += increment;
                            }
                        }
                        }, 1);
                    }



                    function calculateBSD(propertyPrice) {
                        const tier1Limit = 180000;
                        const tier2Limit = tier1Limit + 180000;
                        const tier3Limit = tier2Limit + 640000;
                        const tier4Limit = tier3Limit + 500000;
                        const tier5Limit = tier4Limit + 1500000;
                        const tier6Limit = 3000000;

                        let stampDuty = 0;

                        if (propertyPrice <= tier1Limit) {
                            stampDuty = propertyPrice * 0.01; // 1% for the first 180000
                        } else if (propertyPrice <= tier2Limit) {
                            stampDuty = tier1Limit * 0.01 + (propertyPrice - tier1Limit) * 0.02; // 2% for the next 180000
                        } else if (propertyPrice <= tier3Limit) {
                            stampDuty = tier1Limit * 0.01 + (tier2Limit - tier1Limit) * 0.02 + (propertyPrice - tier2Limit) * 0.03; // 3% for the next 640000
                        } else if (propertyPrice <= tier4Limit) {
                            stampDuty = tier1Limit * 0.01 + (tier2Limit - tier1Limit) * 0.02 + (tier3Limit - tier2Limit) * 0.03 + (propertyPrice - tier3Limit) * 0.04; // 4% for the next 500000
                        } else if (propertyPrice <= tier5Limit) {
                            stampDuty = tier1Limit * 0.01 + (tier2Limit - tier1Limit) * 0.02 + (tier3Limit - tier2Limit) * 0.03 + (tier4Limit - tier3Limit) * 0.04 + (propertyPrice - tier4Limit) * 0.05; // 5% for the next 1500000
                        } else {
                            stampDuty = tier1Limit * 0.01 + (tier2Limit - tier1Limit) * 0.02 + (tier3Limit - tier2Limit) * 0.03 + (tier4Limit - tier3Limit) * 0.04 + (tier5Limit - tier4Limit) * 0.05 + (propertyPrice - tier5Limit) * 0.06; // 6% for any amount in excess of 3000000
                        }

                        return stampDuty;
                    }

                    function removeZero(input) {
                        const value = input.value;

                        if (value.charAt(0) === '0') {
                            input.value = value.slice(1); // Remove the leading 0
                        } else {
                        }
                    }

                    function formatNumberToDollar(number) {
                        // Convert number to dollar notation with commas
                        return Number(number).toLocaleString('en-US', {
                            style: 'currency',
                            currency: 'USD',
                            maximumFractionDigits: 0

                        });
                    }

                    function calculateABSD(propertyCount, mainApplicantCitizenship, jointApplicantCitizenship) {
                        const singaporeanTaxSingleProperty = 0.2;
                        const prTaxSingleProperty = 0.3;
                        const foreignerTaxSingleProperty = 0.6;

                        const singaporeanTaxMultipleProperties = 0.3;
                        const prTaxMultipleProperties = 0.35;
                        const foreignerTaxMultipleProperties = 0.6;

                        let tax = 0;

                        if (propertyCount === 1) {
                            // Single property
                            if (mainApplicantCitizenship === 'Singaporean') {
                                tax = singaporeanTaxSingleProperty;
                            } else if (mainApplicantCitizenship === 'PR') {
                                tax = prTaxSingleProperty;
                            } else {
                                tax = foreignerTaxSingleProperty;
                            }
                        } else if(propertyCount > 1 ) {
                            // Multiple properties
                            if (mainApplicantCitizenship === 'Singaporean') {
                                tax = singaporeanTaxMultipleProperties;
                            } else if (mainApplicantCitizenship === 'PR') {
                                tax = prTaxMultipleProperties;
                            } else {
                                tax = foreignerTaxMultipleProperties;
                            }
                        }

                        // Check if joint applicant has different citizenship
                        if (jointApplicantCitizenship && jointApplicantCitizenship !== mainApplicantCitizenship) {
                            tax = Math.max(tax, calculateABSD(propertyCount, jointApplicantCitizenship, null));
                        }

                        // Calculate the actual tax amount based on the property price
                        return tax;
                    }

               function calculateABSDWithZeroProperty(mainApplicantCitizenship, jointApplicantCitizenship){
                let tax = 0;    
                const prTax = 0.05;
                const foreignerTax = 0.6;

                if (mainApplicantCitizenship === 'PR') {
                    tax = prTax;
                } else if (mainApplicantCitizenship === 'Foreigner') {
                    tax = foreignerTax;
                }

                if(jointApplicantCitizenship && jointApplicantCitizenship !== mainApplicantCitizenship){
                    tax = Math.max(tax, calculateABSDWithZeroProperty(mainApplicantCitizenship, null));
                }
                console.log(tax);
                return tax;
               }
               
               
               
               </script>
                <script>
                    $(function () {
                      $("select").selectize();
                    });
                  </script>
            </body>
        </html>
